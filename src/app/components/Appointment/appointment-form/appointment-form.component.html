<form [formGroup]="form" (ngSubmit)="onSave()">
  <div class="form-grid">
    <div class="form-row">
      <label>Patient</label>
      <div>
        <select formControlName="patientId">
  <option value="">-- Select Patient --</option>
  <option *ngFor="let p of patientList" [value]="p.id">
    {{ p.fullName }}
  </option>
</select>

        <div class="error" *ngIf="form.controls['patientId'].touched && form.controls['patientId'].invalid">
          <small *ngIf="form.controls['patientId'].errors?.['required']">Patient is required</small>
        </div>
      </div>
    </div>

    <div class="form-row">
      <label>Doctor</label>
      <div>
        <select formControlName="doctorId">
  <option value="">-- Select Doctor --</option>
  <option *ngFor="let d of doctorList" [value]="d.id">
    {{ d.fullName }}
  </option>
</select>

        <div class="error" *ngIf="form.controls['doctorId'].touched && form.controls['doctorId'].invalid">
          <small *ngIf="form.controls['doctorId'].errors?.['required']">Doctor is required</small>
        </div>
      </div>
    </div>

    <div class="form-row">
      <label>Start</label>
      <div>
        <input type="datetime-local" formControlName="startTime" />
      </div>
    </div>

    <div class="form-row">
      <label>End</label>
      <div>
        <input type="datetime-local" formControlName="endTime" />
      </div>
    </div>

    <div class="form-row">
      <label>Subject</label>
      <div>
        <input formControlName="subject" />
        <div class="error" *ngIf="form.controls['subject'].touched && form.controls['subject'].invalid">
          <small *ngIf="form.controls['subject'].errors?.['required']">Subject required</small>
          <small *ngIf="form.controls['subject'].errors?.['minlength']">Min 3 chars</small>
          <small *ngIf="form.controls['subject'].errors?.['maxlength']">Max 100 chars</small>
        </div>
      </div>
    </div>

    <div class="form-row">
      <label>Description</label>
      <div>
        <textarea formControlName="description" rows="3"></textarea>
        <div class="error" *ngIf="form.controls['description'].touched && form.controls['description'].invalid">
          <small *ngIf="form.controls['description'].errors?.['maxlength']">Max 1000 chars</small>
        </div>
      </div>
    </div>

    <div class="form-row">
      <label>Doctor Comment</label>
      <div>
        <textarea formControlName="doctorComment" rows="2"></textarea>
        <div class="error" *ngIf="form.controls['doctorComment'].touched && form.controls['doctorComment'].invalid">
          <small *ngIf="form.controls['doctorComment'].errors?.['maxlength']">Max 1000 chars</small>
        </div>
      </div>
    </div>

    <div class="form-actions">
      <button type="submit" [disabled]="form.invalid" class="btn btn-primary">Save</button>
      <button type="button" class="btn btn-secondary" (click)="cancel.emit()">Cancel</button>
    </div>

    <div *ngIf="form.errors" class="error-summary">
      <small *ngIf="form.errors['pastAppointment']">Appointment cannot be in the past.</small>
      <small *ngIf="form.errors['invalidRange']">Start must be before End.</small>
      <small *ngIf="form.errors['durationError']">Duration must be exactly 1 hour.</small>
      <small *ngIf="form.errors['officeHours']">Appointment must be between 10:00 and 17:00.</small>
    </div>
  </div>
</form>
